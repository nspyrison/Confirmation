% This is a LaTeX thesis template for Monash University.
% to be used with Rmarkdown
% This template was produced by Rob Hyndman
% Version: 6 September 2016

\documentclass{monashthesis}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Add any LaTeX packages and other preamble here if required
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\author{Nicholas S Spyrison}
\title{Dynamic visualization of high-dimensional data via low-dimension
projections and sectioning across 2D and 3D display devices}
\degrees{B.Sc. Statistics, Iowa State University}
\def\degreetitle{Doctor of Philosophy}
% Add subject and keywords below
\hypersetup{
     %pdfsubject={The Subject},
     %pdfkeywords={Some Keywords},
     pdfauthor={Nicholas S Spyrison},
     pdftitle={Dynamic visualization of high-dimensional data via low-dimension
projections and sectioning across 2D and 3D display devices},
     pdfproducer={Bookdown with LaTeX}
}


\bibliography{thesisrefs}

\begin{document}

\pagenumbering{roman}

\titlepage

{\setstretch{1.2}\sf\tighttoc\doublespacing}

\chapter{spinifex: manual control of dynamic linear projections of
high-dimensional
data}\label{spinifex-manual-control-of-dynamic-linear-projections-of-high-dimensional-data}

\section{Abstract}\label{abstract}

The class of dynamic linear projections that are collectively known as
`tours' provide a unique means of visualizing numeric multivariate data.
Tours are particularly useful for understanding the structure held
within multivariate data, and in association with techniques for
dimension reduction, supervised, and unsupervised classification. The
\emph{R} package \emph{tourr} offers a variety of path generators and
geometric displays for conducting tours. This paper discusses an
extension package, \emph{spinifex}, that adds support for the path
generation of manual tours and extends the display of tours to use with
the contemporary animation packages, \emph{plotly} and \emph{gganimate}.
Manual tours are used to explore the sensitivity of structure as the
contributions of a manipulation variable are changed. This particularly
useful after identifying a feature of interest.

Keywords: manual tour, guided tour, grand tour, projection pursuit, high
dimensional data, multivariate data, data visualization, statistical
graphics, data science.

\section{Introduction}\label{introduction}

A tour is a multivariate data analysis technique in which a sequence of
linear (orthogonal) projections are viewed as an animation while the
orientation of the projection basis is rotated across time. Each frame
of the sequence corresponds to a small change in the projection for a
smooth transition that perseveres continuity.

While there are numerous methods that generate tour paths, this research
focuses on the manual tour. The manual tour was described in
\textcite{cook_manual_1997} and allows a user to control the projection
coefficients of a select variable has in a 2D projection. The
manipulation of these coefficients allows the analyst to explore how
sensitive the projections structure is to these changes. This makes
manual tours particularly useful once a feature of interest has been
identified, for example, with the use of a guided tour
\autocite{cook_grand_1995}. The path of a guided tour is selected via
projection pursuit, the optimization of an index function on the
projection via a hill climbing algorithm. This allows guided tours to
identify interesting projection features rapidly given the relatively
large parameter-space. Once the given projection has been provided, it
is time to define the path of rotation.

Ideally the path would be intuitively user-generated from physical
movement, be it through mouse or motion capture. Unfortunately this type
of dynamic control has proven difficult to capture for in R. Because of
this manual tours were not implemented within \emph{tourr}. This
research allows for the consumption, but not the generation, of such
dynamic input. After the capture of an oblique user motion the rotation
needs to be applied to step 3 (rotation sequence) of the algorithm
discussed below. In the section below we stick with a radial rotation
where, \(\theta\), the angle of in-projection-plane rotation is held
constant.

Spinifex utilizes two new animation packages, \emph{plotly}
\autocite{sievert_plotly_2018} and \emph{gganimate}
\autocite{pedersen_gganimate:_2019}, to display tours, manual or other
saved tours. From a given projection, the user can choose which variable
to control, and the animation sequence is generated to remove the
variable from the projection, and then extend its contribution to be the
sole variable in one direction. This allows the viewer to assess the
change in structure induced in the projection by the variable's
contribution.

The paper is organized as follows. Section \ref{sec:algorithm} explains
the algorithm using a toy dataset. Section \ref{sec:display} discussed
the display of the animation after the path has been generated. Section
\ref{sec:application} illustrates how this can be used for sensitivity
analysis applied to contemporary high energy physics. The last section,
\ref{sec:discussion} summarizes the work and discusses future research.

\section{Algorithm}\label{sec:algorithm}

The section below discribes the algorithm for performing a 2D radial
manual tour:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  Provided with a 2D projection, choose a variable to explore. This is
  called the ``manip'' variable.
\item
  Create a 3D manipulation space, where the manip variable has the full
  contribution.
\item
  Generate a rotation sequence which increases the norm of the
  coefficient to 1 and zeros it.
\end{enumerate}

The steps are described in more detail below.

\subsection{Notation}\label{notation}

This section describes the notation used in the algorithm for a 2D
radial manual tour.

\begin{itemize}
  \item $\textbf{X}$, the data, an $n \times p$ numeric matrix to be embedded in two dimensions.
  \item $\textbf{B} = (B_1,~ B_2)$, any of orthonormal projection basis set, $p \times 2$ matrix, describing the projection from $p$ to two dimensions
  \item $\textbf{e}$, a zero column vector of length $p$ with the $k-$th element set to one, where $k$ is the number of the variable to manipulate.
\end{itemize}

--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{}

--\textgreater{}

--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{}

--\textgreater{}

--\textgreater{}

--\textgreater{}

--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{} --\textgreater{} --\textgreater{} --\textgreater{}
--\textgreater{} --\textgreater{} --\textgreater{}

--\textgreater{}

\section{Display projection sequence}\label{sec:display}

To get back to data-space pre-multiply each rotated manip space by the
data for the projection in data-space.

\begin{align}
  \textbf{P}_{[n,~d+1]}
    &= \textbf{X}_{[n,~p]} ~*~ \textbf{RM}_{[p,~d+1]} \\
    &=
      \begin{bmatrix}
          X_{1,~1} & \dots & X_{1,~p} \\
          X_{2,~1} & \dots & X_{2,~p} \\
          \vdots   & \vdots & \vdots  \\
          X_{n,~1} & \dots & X_{n,~p}
      \end{bmatrix}_{[n,~p]}
      ~*~
      \begin{bmatrix}
        RM_{1,~1} & RM_{1,~2} & RM_{1,~3} \\
        RM_{2,~1} & RM_{2,~2} & RM_{2,~3} \\
        \vdots     & \vdots     & \vdots     \\
        RM_{p,~1} & RM_{p,~2} & RM_{p,~3}
      \end{bmatrix}_{[p,~d+1]}
\end{align}

Plot the first 2 variables from each projection in sequence for an
\(XY\) scatterplot. The remaining variable is sometimes linked to a data
point aesthetic to produce depth cues used in conjunction with the
\(XY\) scatterplot.

\emph{tourr} utilizes R's base graphics for the display of tours. Use
\texttt{render\_plotly()} to display as an dynamic \texttt{plotly}
\textcite{sievert_plotly_2018} object or \texttt{render\_gganimate()}
for a \texttt{gganimate} \textcite{pedersen_gganimate:_2019} graphic.
Both of which build off of \texttt{ggplot2} plotting in internal
functions.

Interaction with graphics in R is limited. Traditionally, all commands
are passed to the R via calls to the console, conflicting with user
engagement. Some recent packages have made advancement into this
direction such as with the use of the R package \texttt{shiny}
\autocite{chang_shiny:_2018}, which allows applications can be hosted
either locally or remotely and communicate with the R console, allowing
for developers to code dynamic content interaction. To a lesser extent,
\texttt{plotly} offers static interactions with the contained object,
such as tooltips, brushing, and linking without communicating back to
the R console.

\subsection{Storage and sharing}\label{storage-and-sharing}

Storing each data point for every frame of the animation is very
inefficient. In the same way that we gain efficiency by performing math
on the bases, that is the same approach suggested for storage and
sharing tours. Consider a radial manual tour, we can store the salient
features in 3 bases, where \(\phi\) is at its starting, minimum, and
maximum values. The frames in between can be interpolated by supplying
angular speed. By using the function \texttt{tourr::save\_history()} we
can do just that. Save such tour path history and a single set of data
offers performant storage and transfer.

\section{Application}\label{sec:application}

In a recent paper, \textcite{wang_visualizing_2018}, the authors
aggregate and visualize the sensitivity of hadronic experiments, in the
field of high energy physics. The authors introduce a new tool,
PDFSense, to aid in the visualization of parton distribution functions
(PDF). The parameter-space of these experiments lies in 56 dimensions,
\(\delta \in \mathbb{R}^{56}\), and are presented in as 2D subspaces of
the 6 and 10 first principal components in linear and non-linear
embeddings.

The work in \textcite{cook_dynamical_2018} applies manual tours to
discern the finer structure of this sensitivity. Table 1 of Cook et. al.
summaries the key findings of PDFSense \& TFEP (TensorFlow embedded
projections) and those from manual tours. The authors selected the 6
first principal components, containing 48\% of the variation held within
the full data when centered, but not sphered. This data contained 3
clusters: jet, DIS, and VBP. The initial basis sets used below are
obtained from projections used in figures 7 and 8 of the previous study
(jet and DIS clusters respectively) of the previous study and apply
manual tours to explore the local structure with finer precision.

\subsection{Jet cluster}\label{jet-cluster}

The jet cluster is of particular interest as it contains the largest
data sets and is found to be important in
\textcite{wang_visualizing_2018}. The jet cluster resides in a smaller
dimensionality than the full set of experiments with 4 principal
components explaining 95\% of its variation
\autocite{cook_dynamical_2018}. We subset the data down to ATLAS7old and
ATLAS7new to narrow in on 2 groups with a reasonable number of
observations and occupy different parts of the subspace. Below, we
perform radial manual tours on various principal components within this
scope. In PC3 and PC4 are manipulated in figure \ref{fig:JetClusterGood}
and figure \ref{fig:JetClusterBad} respectively. Manipulating PC3, where
varying the angle of rotation brings interesting features into and out
of the center mass of the data, is more interesting than the
manipulation of PC4, where the features are mostly independent of the
contribution of PC4.










\begin{figure}

{\centering \includegraphics[width=6in,height=7.2in]{confirmation_report_ns_files/figure-latex/JetClusterGood-1} 

}

\caption{Jet cluster, a radial manual tour of PC3.
Colored by experiment type: `ATLAS7new' in green and `ATLAS7old' in
orange. When PC3 fully contributes to the projection ATLAS7new (green)
occupies unique space and several outliers are identifiable. Zeroing the
contribution from PC3 to the projection hides the outliers and indeed
all observations with ATLAS7new are contained within ATLAS7old (orange).
A dynamic version can be viewed at
\url{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc3/}.}\label{fig:JetClusterGood}
\end{figure}









\begin{figure}

{\centering \includegraphics[width=6in,height=7.2in]{confirmation_report_ns_files/figure-latex/JetClusterBad-1} 

}

\caption{Jet cluster, a radial manual tour of PC4.
Colored by experiment type: `ATLAS7new' in green and `ATLAS7old' in
orange. This tour contains less interesting information ATLAS7new
(green) has points that are right and left of ATLAS7old, while most
points occupy the same projection space, regardless of the contribution
of PC4. A dynamic version can be viewed at
\url{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc3/}.}\label{fig:JetClusterBad}
\end{figure}

Jet cluster manual tours manipulating each of the principal components
can be viewed from the links:
\href{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc1/}{PC1},
\href{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc2/}{PC2},
\href{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc3/}{PC3},
and
\href{https://nspyrison.netlify.com/thesis/jetcluster_manualtour_pc4/}{PC4}.

\subsection{DIS cluster}\label{dis-cluster}

We perform a manual tour on this data, manipulating PC6 as depicted in
figure \ref{fig:DISclusterGood}. Looking at several frames we see that
DIS HERA data lies mostly on a plane. When PC6 has full contributions,
we see the dimuon SIDIS in purple is almost orthogonal to the DIS HERA
(green). Yet the contribution of PC6 has zeroed the dimuon SIDIS data
occupy the same space as the DIS HERA data. A dynamic version of this
manual tour can be found at:
\url{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc6/}.
The page may some time to load, as the animation is several megabytes.











\begin{figure}

{\centering \includegraphics[width=6in,height=7.2in]{confirmation_report_ns_files/figure-latex/DISclusterGood-1} 

}

\caption{DIS cluster, a radial manual tour of PC6.
colored by experiment type: `DIS HERA1+2' in green, `dimuon SIDIS' in
purple, and `charm SIDIS' in orange. When the contribution PC 6 is large
we see that dimuon SIDIS (purple) data are nearly orthogonal to DIS HERA
(green) data. As the projection is rotated, we can also see that DIS
HERA (green) practically lies on a plane in this 6-d subspace. When the
contribution of PC6 is near zero, dimonSIDIS (purple) occupies the same
space as the DIS HERA data. A dynamic version can be viewed at
\url{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc6/}.}\label{fig:DISclusterGood}
\end{figure}

The selection of the correct manip variable is important as the
manipulation spaces convey different information. For example, in figure
\ref{fig:DISclusterBad} we select PC2 as the manip variable finding it
to be less insightful than PC6.










\begin{figure}

{\centering \includegraphics[width=6in,height=7.2in]{confirmation_report_ns_files/figure-latex/DISclusterBad-1} 

}

\caption{DIS cluster, a radial manual tour of PC2.
Colored by experiment type: `DIS HERA1+2' in green, `dimuon SIDIS' in
purple, and `charm SIDIS' in orange. The structure of previously
described plane of DIS HERA (green) and nearly orthogonal dimuon SIDIS
(purple) is present, however, the manipulating PC2 does not give a
head-on view of either, a less useful manual tour than that of PC6. A
dynamic version can be viewed at
\url{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc2/}.}\label{fig:DISclusterBad}
\end{figure}

DIS cluster manual tours manipulating each of the principal components
can be viewed from the links:
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc1/}{PC1},
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc2/}{PC2},
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc3/}{PC3},
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc4/}{PC4},
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc5/}{PC5},
and
\href{https://nspyrison.netlify.com/thesis/discluster_manualtour_pc6/}{PC6}.

\section{Source code and usage}\label{source-code-and-usage}

This article was created in \texttt{R} \autocite{r_core_team_r:_2018},
using \texttt{bookdown} \autocite{xie_bookdown:_2016} and
\texttt{rmarkdown} \autocite{xie_r_2018}, with code generating the
examples inline. The source files can be found at
\href{https://github.com/nspyrison/confirmation/}{github.com/nspyrison/confirmation/}.

The source code for the \texttt{spinifex} package can be found at
\href{https://github.com/nspyrison/spinifex/}{github.com/nspyrison/spinifex/}.
To install the package in R, run:

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# install.package("devtools")}
\NormalTok{devtools}\OperatorTok{::}\KeywordTok{install_github}\NormalTok{(}\StringTok{"nspyrison/spinifex"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\section{Discussion}\label{sec:discussion}

This research has modified the algorithm producing manual tours in
extends animations of tours to other graphics packages. Tour paths
generated in \texttt{tourr} can also be viewed using these frameworks.

Future research on the algorithm would include extending it for use in
3D projections. This would allow for projections in immersive virtual
reality, which may allow for a better perception of structure and enable
function visualization. The \texttt{tourr} package provides many other
geometric displays with the \texttt{tourr::display\_*()} family. These
other geoms should be integrated into the \texttt{ggplot2} framework for
display on \texttt{plotly} and \texttt{gganimate}.

The Givens rotations and Householder reflections as outlined in
\textcite{buja_computational_2005} could also be added. Currently,
Gram-Schmidt is the only form of frame interpolation used. In a Givens
rotation, the \(x\) and \(y\) components (for example
\(\theta~= 0,~pi/2\)) of the in-plane rotation are calculated separately
and would be applied sequentially to produce the radial rotation.
Householder reflections define reflection axes to project points on to
the axes and generate rotations.

The development of a dynamic graphical user interface, perhaps with the
use of a \texttt{shiny} app, would allow analysts to rapidly try manual
tours with a more intuitive interaction than the command line. The user
could easily switch between variables to control, adjust the step size
to make smoother rotation sequences, or save any state to continue to
explore the contributions of other variables. The \texttt{animation}
package \textcite{xie_animation:_2018} could be implemented for another
graphics framework. However, \texttt{animation} builds from base graphs
while \texttt{spinifex} current utilizes \texttt{ggplot2} graphics.

\printbibliography[heading=bibintoc]



\end{document}
